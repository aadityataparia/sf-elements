/*! SifrrStater v0.0.4 - sifrr project | MIT licensed | https://github.com/sifrr/sifrr-elements */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@sifrr/dom"),require("@sifrr/storage")):"function"==typeof define&&define.amd?define(["@sifrr/dom","@sifrr/storage"],e):(t=t||self).SifrrStater=e(t.Sifrr.Dom,t.Sifrr.Storage)}(this,function(t,e){"use strict";function s(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}t=t&&t.hasOwnProperty("default")?t.default:t,e=e&&e.hasOwnProperty("default")?e.default:e;function i(){const t=s(['<style media="screen">\n  ','\n</style>\n<div class="headings">\n  <ul>\n    <slot name="heading">\n    </slot>\n  </ul>\n  <div class="underline"></div>\n</div>\n<div class="content">\n  <div class="arrow l" _click=${this.prev}>\n    <span></span>\n  </div>\n  <div class="arrow r" _click=${this.next}>\n    <span></span>\n  </div>\n  <div class="tabs">\n    <slot name="tab">\n    </slot>\n  </div>\n</div>'],['<style media="screen">\n  ','\n</style>\n<div class="headings">\n  <ul>\n    <slot name="heading">\n    </slot>\n  </ul>\n  <div class="underline"></div>\n</div>\n<div class="content">\n  <div class="arrow l" _click=\\${this.prev}>\n    <span></span>\n  </div>\n  <div class="arrow r" _click=\\${this.next}>\n    <span></span>\n  </div>\n  <div class="tabs">\n    <slot name="tab">\n    </slot>\n  </div>\n</div>']);return i=function(){return t},t}const n=t.template(i(),":host{\n  /* CSS for tabs container */line-height:24px;overflow:hidden;display:block;border:1px solid rgba(0,0,0,.1);border-radius:5px}.headings,:host{width:100%;position:relative}.headings{\n  /* CSS for heading bar */overflow-y:hidden;overflow-x:auto;background:#714cfe;box-shadow:0 2px 3px rgba(0,0,0,.2)}.headings ul{padding:0 0 3px;margin:0;font-size:0}\n\n/* CSS for heading text li */.headings ::slotted(li){font-size:16px;display:inline-block;text-align:center;padding:8px;text-decoration:none;list-style:none;color:#fff;border-bottom:2px solid transparent;opacity:.9;cursor:pointer;box-sizing:border-box}.headings ::slotted(li.active),.headings ::slotted(li:hover){opacity:1}\n\n/* CSS for line under active tab heading */.headings .underline{position:absolute;bottom:0;left:0;height:3px;background:#fff}\n\n/* Arrows css */.arrow{z-index:5;top:0;bottom:0;width:20px}.arrow,.arrow>*{position:absolute}.arrow>*{width:8px;height:8px;margin:-6px 5px;top:50%;border:solid #fff;border-width:0 3px 3px 0;display:inline-block;padding:3px;filter:drop-shadow(-1px -1px 3px #000)}.arrow.l{left:0}.arrow.l>*{left:0;transform:rotate(135deg)}.arrow.r{right:0}.arrow.r>*{right:0;transform:rotate(-45deg)}\n\n/* Tab container css */.content{width:100%;height:100%;overflow-x:auto;overflow-y:hidden;margin:0;line-height:normal;box-sizing:border-box}.content .tabs{min-height:1px}\n\n/* Tab element css */.content ::slotted([slot=tab]){float:left;max-height:100%;height:100%;overflow-x:hidden;overflow-y:auto;vertical-align:top;padding:8px;box-sizing:border-box}");function a(t,e,s){t instanceof HTMLElement&&(t=t.children);for(let i=0;i<t.length;i++)i!==s&&t[i]!==s?t[i].classList.remove(e):t[i].classList.add(e)}class o extends t.Element{static get template(){return n}static observedAttrs(){return["options"]}onConnect(){this._connected=!0,this.refresh(),this.setWindowResizeEvent(),this.setSlotChangeEvent(),this.setScrollEvent()}onAttributeChange(t,e,s){"options"===t&&(this._attrOptions=JSON.parse(s||"{}"),this._connected&&this.refresh())}refresh(){this.options=Object.assign({menu:this.$(".headings ul"),content:this.$(".content"),tabcontainer:this.$(".tabs"),menus:this.$("slot[name=heading]").assignedNodes(),tabs:this.$("slot[name=tab]").assignedNodes(),la:this.$(".arrow.l"),ra:this.$(".arrow.r"),line:this.$(".underline"),num:1,showArrows:!1,arrowMargin:0,showMenu:!0,step:1,tabHeight:"auto",showUnderline:!0,loop:!1,animation:"easeOut",animationTime:300,scrollBreakpoint:.2},this._attrOptions),!this.options.tabs||this.options.tabs.length<1||(this.usableWidth=this.clientWidth,this.margin=0,this.totalWidth=this.usableWidth/this.options.num*this.options.tabs.length,this.options.showArrows&&(this.usableWidth-=2*this.options.arrowMargin,this.margin=this.options.arrowMargin),this.tabWidth=this.usableWidth/this.options.num,this.setProps(),this.active=this.active||0)}setProps(){this.options.showArrows?(this.options.la.style.display="block",this.options.ra.style.display="block",Array.from(this.options.tabs).forEach(t=>t.style.margin="0 ".concat(this.margin,"px"))):(this.options.la.style.display="none",this.options.ra.style.display="none"),this.options.showUnderline||(this.options.line.style.display="none"),this.options.showMenu?(this.options.menu.style.display="block",this.setMenuProps(),this.options.line.style.width=this.options.menus[0].offsetWidth+"px"):this.options.menu.style.display="none",this.options.tabcontainer.style.width=this.totalWidth+"px",this.options.tabcontainer.style.height=this.options.tabHeight,Array.from(this.options.tabs).forEach(t=>t.style.width=this.tabWidth+"px")}setMenuProps(){let t=0;this.options.menuProps=[],Array.from(this.options.menus).forEach((e,s)=>{this.options.menuProps[s]={width:e.offsetWidth,left:t},t+=e.offsetWidth,e._click=(()=>this.active=s)});const e=this.options.menuProps[this.options.menus.length-1];this.options.menu.style.width=e.left+e.width+5*this.options.menus.length+"px";const s=this.options.menuProps[this.active];this.options.line.style.left=s.left+"px",this.options.line.style.width=s.width+"px"}setScrollEvent(){let t,e,s=this;function i(){if(!s.options.showMenu)return;e=s.active;const i=s.options.content.scrollLeft/s.clientWidth,n=i%1,a=Math.floor(i),o=s.options.menuProps[a].left*(1-n)+(s.options.menuProps[a+1]||{left:0}).left*n,r=s.options.menuProps[a].width*(1-n)+(s.options.menuProps[a+1]||{width:0}).width*n;s.options.line.style.left=o+"px",s.options.line.style.width=r+"px",s.options.menu.parentElement.scrollLeft=o-(s.width-r)/2,clearTimeout(t),t=setTimeout(function(){i-e<-s.options.scrollBreakpoint?s.active=a:i-e>+s.options.scrollBreakpoint?s.active=a+1:s.active=e},66)}s.options.content.onscroll=(()=>requestAnimationFrame(i))}setWindowResizeEvent(){window.addEventListener("resize",()=>{this._resizing&&clearTimeout(this._resizing),this._resizing=setTimeout(()=>{this._resizing=null,this.refresh()},66)})}setSlotChangeEvent(){const t=this,e=()=>{t.options.menus=t.$$("slot")[0].assignedNodes(),t.options.tabs=t.$$("slot")[1].assignedNodes(),t.refresh()};this.$$("slot")[0].addEventListener("slotchange",e),this.$$("slot")[1].addEventListener("slotchange",e)}get active(){return this.state?this.state.active:0}set active(t){this.state={active:t}}beforeUpdate(){if(!this.options)return;let t=this.state.active;if(t=this.getTabNumber(t),!isNaN(t)&&t!==this.state.active)return this.active=t;this.animate(this.options.content,"scrollLeft",t*(this.tabWidth+2*this.margin),this.options.animationTime,this.options.animation),a(this.options.tabs,"active",t),a(this.options.tabs,"prev",this.getTabNumber(t-1)),a(this.options.tabs,"next",this.getTabNumber(t+1)),a(this.options.menus,"active",t),a(this.options.menus,"prev",this.getTabNumber(t-1)),a(this.options.menus,"next",this.getTabNumber(t+1)),this.options.showArrows&&(this.options.la.style.display=this.hasPrev()||this.options.loop?"block":"none",this.options.ra.style.display=this.hasNext()||this.options.loop?"block":"none")}next(){this.active=this.state.active+this.options.step}hasNext(){return this.active!==this.options.tabs.length-this.options.num}prev(){this.active=this.state.active-this.options.step}hasPrev(){return 0!==this.active}getTabNumber(t){const e=this.options.tabs.length,s=this.options.num;return(t=t<0?t+e:t%e)+s-1>=e&&(t=this.options.loop?0:e-s),t}animate(t,e,s,i,n="easeOut"){const a=t[e],o=s-a,r=this;let l;window.requestAnimationFrame(function h(d){if(d-(l=l||d)>i)return void(t[e]=s);let c=(d-l)/i;t[e]=Math.round(r.animations[n].call(this,c)*o+a),window.requestAnimationFrame(h)})}get animations(){return{linear:t=>t,easeOut:t=>--t*t*t+1,easeIn:t=>t*t*t,none:()=>1}}}o.defaultState={active:0},window&&t.register(o);function r(){const t=s(["<style>\n  ",'\n</style>\n<div id="showHide" _click=${this.showHide}></div>\n<sifrr-tabs options=\'{"tabHeight": "calc(100vh - 132px)"}\' data-sifrr-html="true">\n  ${ this.headingHtml() }\n  ${ this.stateHtml() }\n</sifrr-tabs>\n<footer>\n  <input _keyup=${this.addTargetOnEnter} id="addTargetInput" type="text" name="addTargetInput" value="" placeholder="Enter css selector query of target">\n  <button _click=${this.addTarget} class="btn3" type="button" name="addTargetButton">Add Taget</button>\n  <button _click=${this.commitAll} class="btn3" type="button" name="commitAll">Commit All</button>\n  <button _click=${this.resetAllToFirstState} class="btn3" type="button" name="resetAll">Reset All</button>\n  <button _click=${this.saveData} class="btn3" type="button" name="saveData">Save Data</button>\n  <button _click=${this.loadData} class="btn3" type="button" name="loadData">Load Data</button>\n  <button _click=${this.clearAll} class="btn3" type="button" name="clearAll">Remove All</button>\n</footer>'],["<style>\n  ",'\n</style>\n<div id="showHide" _click=\\${this.showHide}></div>\n<sifrr-tabs options=\'{"tabHeight": "calc(100vh - 132px)"}\' data-sifrr-html="true">\n  \\${ this.headingHtml() }\n  \\${ this.stateHtml() }\n</sifrr-tabs>\n<footer>\n  <input _keyup=\\${this.addTargetOnEnter} id="addTargetInput" type="text" name="addTargetInput" value="" placeholder="Enter css selector query of target">\n  <button _click=\\${this.addTarget} class="btn3" type="button" name="addTargetButton">Add Taget</button>\n  <button _click=\\${this.commitAll} class="btn3" type="button" name="commitAll">Commit All</button>\n  <button _click=\\${this.resetAllToFirstState} class="btn3" type="button" name="resetAll">Reset All</button>\n  <button _click=\\${this.saveData} class="btn3" type="button" name="saveData">Save Data</button>\n  <button _click=\\${this.loadData} class="btn3" type="button" name="loadData">Load Data</button>\n  <button _click=\\${this.clearAll} class="btn3" type="button" name="clearAll">Remove All</button>\n</footer>']);return r=function(){return t},t}const l=t.template(r(),':host{position:fixed;right:0;top:0;bottom:0;height:100%;max-width:100%;width:320px;z-index:1000;background-color:rgba(0,0,0,.8);transform:translate3d(100%,0,0);transition:all .2s ease}:host(.show){transform:translateZ(0)}*{box-sizing:border-box}#showHide{position:fixed;left:-30px;top:0;bottom:0;width:30px;height:30px;margin-top:5px;background-color:#00f;z-index:2}.stateContainer{padding-left:10px;margin-left:10px;border-left:1px solid #fff;position:relative}.stateContainer.off{opacity:.5}.stateContainer .dotC{position:absolute;top:0;left:-10px;width:20px;height:100%;cursor:pointer}.stateContainer .dotC .dot{position:absolute;top:50%;left:10px;width:10px;height:10px;transform:translate3d(-50%,-50%,0);background-color:#fff;border-radius:50%}.stateContainer .delete{position:absolute;top:0;right:0;padding:4px;background-color:rgba(0,0,0,.7);color:#fff;cursor:pointer}.state{white-space:pre-wrap;max-height:90px;overflow:hidden;background-color:hsla(0,0%,100%,.97);padding:5px;margin-bottom:5px;position:relative;cursor:pointer}.state:hover:after{content:"\\\\\\/";position:absolute;bottom:0;left:0;width:100%;background-color:rgba(0,0,0,.7);text-align:center;color:#fff}.state.open{max-height:none}.state.open:hover:after{content:"\\/\\\\"}.key{color:red}.string{color:green}.boolean,.null,.number{color:#00f}footer{position:absolute;bottom:0}input{width:calc(100% - 6px)}.btn3,input{margin:3px;padding:3px}.btn3{width:calc(33% - 8px);background:#fff}');t.Event.add("click"),t.Event.add("keyup");class h extends t.Element{static get template(){return l}onConnect(){let s=this;this.storage=new e({name:window.location.href}),t.Event.addListener("click",".state",function(t,e){e.classList.contains("open")?e.classList.remove("open"):e.classList.add("open")}),t.Event.addListener("click",".dotC",function(t,e,i){s.toState(parseInt(i.dataset.target),parseInt(i.dataset.stateIndex))}),t.Event.addListener("click",".delete",function(t,e){s.deleteState(parseInt(e.dataset.target),parseInt(e.dataset.stateIndex))}),t.Event.addListener("click",".commit",function(t,e){const i=parseInt(e.parentNode.dataset.target);s.commit(i)}),t.Event.addListener("click",".reset",function(t,e){const i=parseInt(e.parentNode.dataset.target);s.resetToFirstState(i)}),t.Event.addListener("click",".remove",function(t,e){const i=parseInt(e.parentNode.dataset.target);s.removeTarget(i)}),t.Element.onStateChange=function(t){s.addState(t,t.state)}}showHide(){this.classList.contains("show")?this.classList.remove("show"):this.classList.add("show")}addTargetOnEnter(t){"Enter"===t.key&&this.addTarget()}headingHtml(){return this.state.queries.map(t=>'<li slot="heading">'.concat(t,"</li>")).join("")}stateHtml(){let t=this;return this.state.states.map((e,s)=>'<div data-target="'.concat(s,'" slot="tab">\n      <button class="btn3 commit" type="button" name="commit">Commit</button>\n      <button class="btn3 reset" type="button" name="reset">Reset</button>\n      <button class="btn3 remove" type="button" name="remove">Remove</button>\n      ').concat(e.map((e,i)=>'<div class="stateContainer '.concat(i<=t.state.activeStates[s]?"on":"off",'">\n                           <div class="dotC" data-target="').concat(s,'" data-state-index="').concat(i,'"><div class="dot"></div></div>\n                           <div class="state">').concat(h.prettyJSON(e),'</div>\n                           <div class="delete" data-target="').concat(s,'" data-state-index="').concat(i,'">X</div>\n                           </div>')).join(""),"</div>")).join("")}addTarget(t){"string"!=typeof t&&(t=this.$("#addTargetInput").value);const e=window.document.querySelector(t);if(!e.isSifrr)return console.log("Invalid Sifrr Element.",e),!1;if(!e.state)return console.log("Sifrr Element has no state.",e),!1;let s=this.state.targets.indexOf(e);s>-1||(this.state.targets.push(e),this.state.queries.push(t),s=this.state.targets.indexOf(e),this.state.states[s]=[JSON.parse(JSON.stringify(e.state))],this.state.activeStates[s]=0,this.update())}removeTarget(t){const{index:e,target:s}=this.getTarget(t);e>-1&&(this.state.targets.splice(e,1),this.state.queries.splice(e,1),this.state.states.splice(e,1),this.state.activeStates.splice(e,1),this.update())}addState(t,e){const{index:s,target:i}=this.getTarget(t);if(s>-1){const t=this.state.activeStates[s],i=JSON.stringify(e);i!==JSON.stringify(this.state.states[s][t])&&(this.state.states[s].splice(t+1,0,JSON.parse(i)),this.state.activeStates[s]=t+1,this.update())}}deleteState(t,e){const{index:s,target:i}=this.getTarget(t);this.state.states[s].splice(e,1),e<this.state.activeStates[s]?this.state.activeStates[s]-=1:e==this.state.activeStates[s]&&(this.state.activeStates[s]-=1,this.toState(s,this.state.activeStates[s])),this.update()}commit(t){const{index:e,target:s}=this.getTarget(t),i=this.state.states[e][this.state.states[e].length-1];this.state.states[e]=[i],this.state.activeStates[e]=0,this.update()}commitAll(){const t=this;this.state.targets.forEach(e=>t.commit(e)),this.update()}toState(t,e){const{index:s,target:i}=this.getTarget(t);this.state.activeStates[s];this.state.activeStates[s]=e,i.state=this.state.states[s][e],this.update()}resetToFirstState(t){const{index:e,target:s}=this.getTarget(t);this.toState(s,0,!1),this.state.states[e]=[this.state.states[e][0]],this.update()}resetAllToFirstState(){const t=this;this.state.targets.forEach(e=>t.resetToFirstState(e)),this.update()}clear(t){const{index:e}=this.getTarget(t);this.state.activeStates[e]=-1,this.state.states[e]=[],this.update()}clearAll(){const t=this;this.state.targets.forEach(e=>t.clear(e)),this.update()}saveData(){const t=this;this.storage.clear().then(()=>{t.state.queries.forEach((e,s)=>{const i={active:t.state.activeStates[s],states:t.state.states[s]};t.storage.insert(e,i)})})}loadData(){const t=this;this.storage.data().then(e=>{let s=0;for(let i in e)t.addTarget(i),t.clear(s),e[i].states.forEach(e=>t.addState(s,e)),t.toState(s,e[i].active),s++})}getTarget(t){let e;return Number.isInteger(t)?(e=t,t=this.state.targets[e]):e=this.state.targets.indexOf(t),{index:e,target:t}}static prettyJSON(t){return(t=(t=JSON.stringify(t,null,4)).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(t){var e="number";return/:$/.test(t)?'<span class="'+(e="key")+'">'+t+"</span>":(/^"/.test(t)?e="string":/true|false/.test(t)?e="boolean":/null/.test(t)&&(e="null"),'<span class="'+e+'">'+t+"</span>")})}}return h.defaultState={targets:[],states:[],queries:[],activeStates:[]},window&&t.register(h),h});
/*! (c) @aadityataparia */
