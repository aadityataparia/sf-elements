{"version":3,"file":"sifrrtabs.js","sources":["../../../helpers/animate.js","../src/sifrrtabs.js"],"sourcesContent":["const types = {\n  linear: [0, 0, 1, 1],\n  ease: [.25, .1, .25, 1],\n  easeIn: [.42, 0, 1, 1],\n  easeOut: [0, 0, .58, 1],\n  easeInOut: [.42, 0, .58, 1]\n};\n\nclass Bezier {\n  constructor(args){\n    this.setProps(...args);\n    return this.final.bind(this);\n  }\n\n  setProps(x1, y1, x2, y2) {\n    let props = {\n      x1: x1,\n      y1: y1,\n      x2: x2,\n      y2: y2,\n      A: (aA1, aA2) => 1.0 - 3.0 * aA2 + 3.0 * aA1,\n      B: (aA1, aA2) => 3.0 * aA2 - 6.0 * aA1,\n      C: (aA1) => 3.0 * aA1,\n      CalcBezier: (aT, aA1, aA2) => ((this.A(aA1, aA2)*aT + this.B(aA1, aA2))*aT + this.C(aA1))*aT,\n      GetSlope: (aT, aA1, aA2) => 3.0 * this.A(aA1, aA2)*aT*aT + 2.0 * this.B(aA1, aA2) * aT + this.C(aA1)\n    };\n    Object.assign(this, props);\n  }\n\n  final(x) {\n    if (this.x1 == this.y1 && this.x2 == this.y2) return x;\n    return this.CalcBezier(this.GetTForX(x), this.y1, this.y2);\n  }\n\n  GetTForX(xx) {\n    let t = xx;\n    for (let i = 0; i < 4; ++i) {\n      let slope = this.GetSlope(t, this.x1, this.x2);\n      if (slope == 0.0) return t;\n      let x = this.CalcBezier(t, this.x1, this.x2) - xx;\n      t -= x / slope;\n    }\n    return t;\n  }\n}\n\nfunction animateOne(who, what, to, time = 300, { type = 'ease', from, onUpdate = () => {}, round = false } = {}) {\n  let toBefore = to, preffix = false, suffix = false;\n  if (typeof to === 'string') {\n    [preffix, to, suffix] = to.split(/(\\d+)(.*)?/);\n    [, from, ] = (from || who[what]).split(/(\\d+)(.*)?/);\n    from = Number(from), to = Number(to);\n  } else {\n    from = who[what];\n  }\n  const diff = to - from;\n  const animeFxn = new Bezier(types[type] || type);\n  let startTime;\n\n  return new Promise(res => {\n    function frame(currentTime) {\n      startTime = startTime || currentTime;\n      const percent = (currentTime - startTime) / time;\n      if (percent >= 1) {\n        who[what] = toBefore;\n        return res();\n      }\n      let next = animeFxn(percent) * diff + from;\n      if (round) next = Math.round(next);\n      if (!suffix && !preffix) who[what] = next;\n      else who[what] = (preffix ? preffix : '') + next + (suffix ? suffix : '');\n      onUpdate(who, what, who[what]);\n      window.requestAnimationFrame(frame);\n    }\n    window.requestAnimationFrame(frame);\n  });\n}\n\nfunction animate({\n  targets,\n  target,\n  to,\n  time,\n  type,\n  onUpdate,\n  round\n} = {}) {\n  targets = targets ? Array.from(targets) : [target];\n  function iterate(target, props) {\n    const promises = [];\n    for (let prop in props) {\n      let from, final;\n      if (Array.isArray(props[prop])) [from, final] = props[prop];\n      else final = props[prop];\n      promises.push(animateOne(target, prop, final, time, { type, from, onUpdate, round }));\n    }\n    return Promise.all(promises);\n  }\n  return Promise.all(targets.map(target => iterate(target, to)));\n}\n\nanimate.types = types;\n\nfunction wait(time = 0) {\n  return new Promise(res => setTimeout(res, time));\n}\n\nexport default {\n  animate,\n  types,\n  wait\n};\nexport {\n  animate,\n  types,\n  wait\n};\n","import SifrrDom from '@sifrr/dom';\nimport style from './style.scss';\nimport { animate } from '../../../helpers/animate';\n\nconst template = SifrrDom.template`<style media=\"screen\">\n  ${style}\n</style>\n<style>\n  .tabs {\n    height: \\${this.options ? this.options.tabHeight : 'auto'};\n    width: \\${this.totalWidth + 'px'};\n  }\n  .headings {\n    display: \\${this.headingDisplay};\n    background: \\${this.options ? this.options.background : 'transparent'};\n  }\n  .content *::slotted([slot=\"tab\"]) {\n    width: \\${this.tabWidth + 'px'};\n    margin: 0 \\${this.options ? this.options.arrowMargin + 'px' : 0};\n  }\n  .arrow {\n    width: \\${this.options ? this.options.arrowWidth : '20px'};\n  }\n</style>\n<div class=\"headings\">\n  <ul>\n    <slot name=\"heading\">\n    </slot>\n  </ul>\n  <div class=\"underline\"></div>\n</div>\n<div class=\"content\">\n  <div class=\"arrow l\" _click=\\${this.prev}>\n    <span></span>\n  </div>\n  <div class=\"arrow r\" _click=\\${this.next}>\n    <span></span>\n  </div>\n  <div class=\"tabs\">\n    <slot name=\"tab\">\n    </slot>\n  </div>\n</div>`;\n\nfunction removeExceptOne(elements, name, index) {\n  if (elements instanceof HTMLElement) elements = elements.children;\n  for (let j = 0; j < elements.length; j++) {\n    j !== index && elements[j] !== index ? elements[j].classList.remove(name) : elements[j].classList.add(name);\n  }\n}\n\n//Simple tabs\nclass SifrrTabs extends SifrrDom.Element {\n  static get template() {\n    return template;\n  }\n\n  static observedAttrs() {\n    return ['options'];\n  }\n\n  onConnect() {\n    this._connected = true;\n    this.refresh();\n    this.setWindowResizeEvent();\n    this.setSlotChangeEvent();\n    this.setScrollEvent();\n  }\n\n  onAttributeChange(n, _, v) {\n    if (n === 'options') {\n      this._attrOptions = JSON.parse(v || '{}');\n      if (this._connected) this.refresh();\n    }\n  }\n\n  refresh() {\n    this.options = Object.assign({\n      menu: this.$('.headings ul'),\n      content: this.$('.content'),\n      tabcontainer: this.$('.tabs'),\n      menus: this.$('slot[name=heading]').assignedNodes(),\n      tabs: this.$('slot[name=tab]').assignedNodes(),\n      la: this.$('.arrow.l'),\n      ra: this.$('.arrow.r'),\n      line: this.$('.underline'),\n      num: 1,\n      showArrows: false,\n      arrowMargin: 0,\n      arrowWidth: '20px',\n      showMenu: true,\n      step: 1,\n      tabHeight: 'auto',\n      showUnderline: true,\n      loop: false,\n      animation: 'ease',\n      animationTime: 300,\n      scrollBreakpoint: 0.2,\n      background: '#714cfe'\n    }, this._attrOptions);\n    if (!this.options.tabs || this.options.tabs.length < 1) return;\n    this.usableWidth = this.clientWidth;\n    this.totalWidth = this.usableWidth / this.options.num * this.options.tabs.length;\n    this.usableWidth -= 2 * this.options.arrowMargin;\n    this.tabWidth = this.usableWidth / this.options.num;\n    this.setProps();\n    this.update();\n    this.active = this.active || 0;\n  }\n\n  setProps() {\n    if (!this.options.showArrows) {\n      this.options.la.style.display = 'none';\n      this.options.ra.style.display = 'none';\n    } else {\n      this.options.la.style.display = 'block';\n      this.options.ra.style.display = 'block';\n      Array.from(this.options.tabs).forEach(e => e.style.margin = `0 ${this.margin}px`);\n    }\n    if (!this.options.showUnderline) this.options.line.style.display = 'none';\n    if (this.options.showMenu) {\n      this.headingDisplay = 'block';\n      this.options.line.style.width = this.options.menus[0].offsetWidth + 'px';\n      this.setMenuProps();\n    } else this.headingDisplay = 'none';\n  }\n\n  setMenuProps() {\n    let left = 0;\n    this.options.menuProps = [];\n    Array.from(this.options.menus).forEach((elem, i) => {\n      this.options.menuProps[i] = {\n        width: elem.offsetWidth,\n        left: left\n      };\n      left += elem.offsetWidth;\n      elem._click = () => this.active = i;\n    });\n    const last = this.options.menuProps[this.options.menus.length - 1];\n    this.options.menu.style.width = last.left + last.width + 5 * this.options.menus.length + 'px';\n    const active = this.options.menuProps[this.active];\n    this.options.line.style.left = active.left + 'px';\n    this.options.line.style.width = active.width + 'px';\n  }\n\n  setScrollEvent() {\n    let me = this,\n      isScrolling,\n      scrollPos;\n    this.options.content.onscroll = () => requestAnimationFrame(onScroll);\n\n    function onScroll() {\n      scrollPos = me.active;\n      const total = me.options.content.scrollLeft / me.tabWidth;\n      const per = total % 1;\n      const t = Math.floor(total);\n      if (me.options.showMenu) {\n        const left = me.options.menuProps[t].left * (1 - per) + (me.options.menuProps[t + 1] || {\n          left: 0\n        }).left * per;\n        const width = me.options.menuProps[t].width * (1 - per) + (me.options.menuProps[t + 1] || {\n          width: 0\n        }).width * per;\n        me.options.line.style.left = left + 'px';\n        me.options.line.style.width = width + 'px';\n        me.options.menu.parentElement.scrollLeft = left + (width - me.tabWidth) / 2;\n      }\n      clearTimeout(isScrolling);\n      isScrolling = setTimeout(function() {\n        if (total - scrollPos < -me.options.scrollBreakpoint) {\n          me.active = t;\n        } else if (total - scrollPos > +me.options.scrollBreakpoint) {\n          me.active = t + 1;\n        } else {\n          me.active = scrollPos;\n        }\n      }, 66);\n    }\n  }\n\n  setWindowResizeEvent() {\n    window.addEventListener('resize', () => requestAnimationFrame(this.refresh.bind(this)));\n  }\n\n  setSlotChangeEvent() {\n    const me = this;\n    const fxn = () => {\n      me.options.menus = me.$$('slot')[0].assignedNodes();\n      me.options.tabs = me.$$('slot')[1].assignedNodes();\n      me.refresh();\n    };\n    this.$$('slot')[0].addEventListener('slotchange', fxn);\n    this.$$('slot')[1].addEventListener('slotchange', fxn);\n  }\n\n  get active() {\n    return this.state ? this.state.active : 0;\n  }\n\n  set active(i) {\n    this.state = {\n      active: i\n    };\n  }\n\n  beforeUpdate() {\n    if (!this.options) return;\n    let i = this.state.active;\n    i = this.getTabNumber(i);\n    if (!isNaN(i) && i !== this.state.active) return this.active = i;\n    animate({\n      target: this.options.content,\n      to: {\n        scrollLeft: i * (this.tabWidth + 2 * this.options.arrowMargin)\n      },\n      time: this.options.animationTime,\n      type: this.options.animation\n    });\n    removeExceptOne(this.options.tabs, 'active', i);\n    removeExceptOne(this.options.tabs, 'prev', this.getTabNumber(i - 1));\n    removeExceptOne(this.options.tabs, 'next', this.getTabNumber(i + 1));\n    removeExceptOne(this.options.menus, 'active', i);\n    removeExceptOne(this.options.menus, 'prev', this.getTabNumber(i - 1));\n    removeExceptOne(this.options.menus, 'next', this.getTabNumber(i + 1));\n    if (this.options.showArrows) {\n      this.options.la.style.display = this.hasPrev() || this.options.loop ? 'block' : 'none';\n      this.options.ra.style.display = this.hasNext() || this.options.loop ? 'block' : 'none';\n    }\n  }\n\n  next() {\n    this.active = this.state.active + this.options.step;\n  }\n\n  hasNext() {\n    if (this.active === this.options.tabs.length - this.options.num) return false;\n    return true;\n  }\n\n  prev() {\n    this.active = this.state.active - this.options.step;\n  }\n\n  hasPrev() {\n    if (this.active === 0) return false;\n    return true;\n  }\n\n  getTabNumber(i) {\n    const l = this.options.tabs.length;\n    const num = this.options.num;\n    i = i < 0 ? i + l : i % l;\n    if (i + num - 1 >= l) {\n      i = this.options.loop ? 0 : l - num;\n    }\n    return i;\n  }\n}\n\nSifrrTabs.defaultState = { active: 0 };\n\nSifrrDom.register(SifrrTabs);\nexport default SifrrTabs;\n"],"names":["types","linear","ease","easeIn","easeOut","easeInOut","Bezier","constructor","args","setProps","final","bind","x1","y1","x2","y2","props","A","aA1","aA2","B","C","CalcBezier","aT","GetSlope","Object","assign","x","GetTForX","xx","t","i","slope","animateOne","who","what","to","time","type","from","onUpdate","round","toBefore","preffix","suffix","split","Number","diff","animeFxn","startTime","Promise","res","frame","currentTime","percent","next","Math","window","requestAnimationFrame","animate","targets","target","Array","iterate","promises","prop","isArray","push","all","map","template","SifrrDom","style","removeExceptOne","elements","name","index","HTMLElement","children","j","length","classList","remove","add","SifrrTabs","Element","observedAttrs","onConnect","_connected","refresh","setWindowResizeEvent","setSlotChangeEvent","setScrollEvent","onAttributeChange","n","_","v","_attrOptions","JSON","parse","options","menu","$","content","tabcontainer","menus","assignedNodes","tabs","la","ra","line","num","showArrows","arrowMargin","arrowWidth","showMenu","step","tabHeight","showUnderline","loop","animation","animationTime","scrollBreakpoint","background","usableWidth","clientWidth","totalWidth","tabWidth","update","active","display","forEach","e","margin","headingDisplay","width","offsetWidth","setMenuProps","left","menuProps","elem","_click","last","me","isScrolling","scrollPos","onscroll","onScroll","total","scrollLeft","per","floor","parentElement","clearTimeout","setTimeout","addEventListener","fxn","$$","state","beforeUpdate","getTabNumber","isNaN","hasPrev","hasNext","prev","l","defaultState","register"],"mappings":"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"}