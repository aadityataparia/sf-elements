{"version":3,"file":"sifrrcodeeditor.module.js","sources":["../src/sifrrcodeeditor.js"],"sourcesContent":["import SifrrDom from '@sifrr/dom';\nimport style from './style.scss';\n\nconst template = SifrrDom.template`\n<style media=\"screen\">\n  ${style}\n</style>\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atom-one-dark.min.css\">\n<pre class='hljs'>\n  <code id=\"highight\" data-sifrr-html=\"true\">\n    \\${this.htmlValue}\n  </code>\n</pre>\n<textarea class='hljs' _input=\"\\${this.input}\"></textarea>`;\n\nSifrrDom.Event.add('load');\nclass SifrrCodeEditor extends SifrrDom.Element {\n  static get template() {\n    return template;\n  }\n\n  onAttributeChange() {\n    this.update();\n  }\n\n  onConnect() {\n    const script = document.createElement('script');\n    script.src = \"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js\";\n    script.onLoad = this.update();\n    document.body.appendChild(script);\n\n    const txtarea = this.$('textarea');\n    this.$('textarea').addEventListener('keydown', (e) => {\n      let keyCode = e.keyCode || e.which;\n      if (keyCode == 9) {\n        e.preventDefault();\n        const start = txtarea.selectionStart;\n        const end = txtarea.selectionEnd;\n\n        const tabCharacter = '  ';\n        const tabOffset = 2;\n\n        // set textarea value to: text before caret + tab + text after caret\n        txtarea.value = txtarea.value.substring(0, start) + tabCharacter + txtarea.value.substring(end);\n\n        // put caret at right position again\n        txtarea.selectionStart = txtarea.selectionEnd = start + tabOffset;\n      }\n    });\n  }\n\n  input() {\n    SifrrDom.Event.trigger(this, 'input');\n    this.update();\n  }\n\n  get htmlValue() {\n    if (window.hljs) return hljs.highlight(this.lang, this.value).value;\n    else return this.value;\n  }\n\n  get value() {\n    return this.$('textarea').value;\n  }\n\n  set value(v) {\n    this.$('textarea').value = v;\n    this.update();\n  }\n\n  get lang() {\n    return this.getAttribute('lang') || 'html';\n  }\n}\n\nif (window) SifrrDom.register(SifrrCodeEditor);\n\nexport default SifrrCodeEditor;\n"],"names":["style"],"mappings":";;;;;AAGA,MAAM,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC;;EAEjC,EAAEA,GAAK,CAAC;;;;;;;;0DAQgD,CAAC,CAAC;AAE5D,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AAC3B,MAAM,eAAe,SAAS,QAAQ,CAAC,OAAO,CAAC;EAC7C,WAAW,QAAQ,GAAG;IACpB,OAAO,QAAQ,CAAC;GACjB;EAED,iBAAiB,GAAG;IAClB,IAAI,CAAC,MAAM,EAAE,CAAC;GACf;EAED,SAAS,GAAG;IACV,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;IAChD,MAAM,CAAC,GAAG,GAAG,6EAA6E,CAAC;IAC3F,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;IAC9B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;IAElC,MAAM,OAAO,GAAG,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;IACnC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,CAAC,KAAK;MACpD,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,KAAK,CAAC;MACnC,IAAI,OAAO,IAAI,CAAC,EAAE;QAChB,CAAC,CAAC,cAAc,EAAE,CAAC;QACnB,MAAM,KAAK,GAAG,OAAO,CAAC,cAAc,CAAC;QACrC,MAAM,GAAG,GAAG,OAAO,CAAC,YAAY,CAAC;QAEjC,MAAM,YAAY,GAAG,IAAI,CAAC;QAC1B,MAAM,SAAS,GAAG,CAAC,CAAC;QAGpB,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,CAAC,GAAG,YAAY,GAAG,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;QAGhG,OAAO,CAAC,cAAc,GAAG,OAAO,CAAC,YAAY,GAAG,KAAK,GAAG,SAAS,CAAC;OACnE;KACF,CAAC,CAAC;GACJ;EAED,KAAK,GAAG;IACN,QAAQ,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IACtC,IAAI,CAAC,MAAM,EAAE,CAAC;GACf;EAED,IAAI,SAAS,GAAG;IACd,IAAI,MAAM,CAAC,IAAI,EAAE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;SAC/D,OAAO,IAAI,CAAC,KAAK,CAAC;GACxB;EAED,IAAI,KAAK,GAAG;IACV,OAAO,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC;GACjC;EAED,IAAI,KAAK,CAAC,CAAC,EAAE;IACX,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC;IAC7B,IAAI,CAAC,MAAM,EAAE,CAAC;GACf;EAED,IAAI,IAAI,GAAG;IACT,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC;GAC5C;CACF;AAED,IAAI,MAAM,EAAE,QAAQ,CAAC,QAAQ,CAAC,eAAe,CAAC,CAAC;;;;;;;"}